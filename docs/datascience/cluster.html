<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="井上 研一"><meta name=twitter:card content="summary"><meta name=twitter:title content="クラスター分析の基礎"><meta name=twitter:description content="irisデータセットについてクラスター分析を行う。 irisデータセットは150個のデータからできており、3つの品種についてそれぞれ50個のデ"><meta property="og:title" content="クラスター分析の基礎"><meta property="og:description" content="irisデータセットについてクラスター分析を行う。 irisデータセットは150個のデータからできており、3つの品種についてそれぞれ50個のデ"><meta property="og:type" content="article"><meta property="og:url" content="https://inoccu.github.io/docs/datascience/cluster.html"><meta property="article:section" content="docs"><meta property="article:published_time" content="2020-05-28T00:00:00+00:00"><meta property="article:modified_time" content="2020-05-28T00:00:00+00:00"><meta property="og:site_name" content="井上 研一"><base href=https://inoccu.github.io/docs/datascience/cluster.html><title>クラスター分析の基礎 - 井上 研一</title><link rel=canonical href=https://inoccu.github.io/docs/datascience/cluster.html><link href="https://fonts.googleapis.com/css?family=Lato:400,700|Noto+Sans+JP:400,700" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://inoccu.github.io/css/coder.min.76681fdb0711c555514e38148a33b692f685093870cba0a00547d255d7518258.css integrity="sha256-dmgf2wcRxVVRTjgUijO2kvaFCThwy6CgBUfSVddRglg=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://inoccu.github.io/css/custom.css><link rel=icon type=image/png href=https://inoccu.github.io/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://inoccu.github.io/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.81.0"></head><body class=colorscheme-light><div id=back_to_top><a href=#></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://inoccu.github.io/>Inoue, Ken'ichi</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/profile/>プロフィール</a></li><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/profile/writing.html>執筆</a></li><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/profile/speaking.html>登壇</a></li><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/docs/>資料</a></li><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/search/>検索</a></li><li class=navigation-item><a class=navigation-link href=https://inoccu.github.io/contact/>お問い合わせ</a></li></ul></section></nav><div class=content><section class="container page"><article><header><h1>クラスター分析の基礎</h1></header><p>irisデータセットについてクラスター分析を行う。</p><p>irisデータセットは150個のデータからできており、3つの品種についてそれぞれ50個のデータが入っている。問題を簡単にするため、それぞれの品種について3つのデータを取ることにする。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> sklearn.datasets <span style=color:#f92672>import</span> load_iris

iris <span style=color:#f92672>=</span> load_iris()
<span style=color:#66d9ef>print</span>(iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>0</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>1</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>2</span>])
<span style=color:#66d9ef>print</span>(iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>50</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>51</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>52</span>])
<span style=color:#66d9ef>print</span>(iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>100</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>101</span>], iris<span style=color:#f92672>.</span>target[<span style=color:#ae81ff>102</span>])
</code></pre></div><p>このように、品種0、品種1、品種2がそれぞれ3件ずつであることが分かる。</p><pre><code>0 0 0
1 1 1
2 2 2
</code></pre><p>対応するデータを取得し、標準化を行う。<br>ちなみに、scikit-learnを用いて標準化した値と、R言語のscale関数で求めた値は<a href=https://ja.coder.work/so/python/1294886>デルタの自由度の値が異なるため、違う値になる</a>ことに注意する。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> StandardScaler

X <span style=color:#f92672>=</span> [iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>0</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>1</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>2</span>], 
     iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>50</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>51</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>52</span>], 
     iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>100</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>101</span>], iris<span style=color:#f92672>.</span>data[<span style=color:#ae81ff>102</span>]
    ]

sc <span style=color:#f92672>=</span> StandardScaler()
X_sc <span style=color:#f92672>=</span> sc<span style=color:#f92672>.</span>fit_transform(X)
X_sc
</code></pre></div><p>このようなデータが得られる。</p><pre><code>array([[-1.04454175,  1.73925271, -1.35065657, -1.30321735],
       [-1.27106888, -0.63245553, -1.35065657, -1.30321735],
       [-1.497596  ,  0.31622777, -1.40444378, -1.30321735],
       [ 1.10746595,  0.31622777,  0.42432131,  0.14778753],
       [ 0.42788457,  0.31622777,  0.31674689,  0.26870461],
       [ 0.99420239, -0.15811388,  0.53189573,  0.26870461],
       [ 0.31462101,  0.79056942,  1.12355502,  1.47787534],
       [-0.25169681, -2.05548048,  0.63947014,  0.7523729 ],
       [ 1.22072952, -0.63245553,  1.06976781,  0.99420705]])
</code></pre><h2 id=データ間の距離を求める>データ間の距離を求める</h2><p>1件目のデータ$x_{1}$と2件目のデータ$x_2$について、ユーグリッド距離を求める。<br>ユーグリッド距離は、それぞれの値の差の平方を足して、その平方根を求めたものである。
$$
d = \sqrt{(x_{1,1}-x_{2,1})^2 + (x_{1,2}-x_{2,2})^2 + (x_{1,3}-x_{2,3})^2 + (x_{1,4}-x_{2,4})^2}
$$</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># X_sc[0]とX_sc[1]のユーグリッド距離を求める</span>
<span style=color:#f92672>import</span> numpy <span style=color:#f92672>as</span> np
np<span style=color:#f92672>.</span>sqrt((X_sc[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> X_sc[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>0</span>]) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span>
        (X_sc[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> X_sc[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>1</span>]) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span>
        (X_sc[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>2</span>] <span style=color:#f92672>-</span> X_sc[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>2</span>]) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span>
        (X_sc[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>3</span>] <span style=color:#f92672>-</span> X_sc[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>3</span>]) <span style=color:#f92672>**</span> <span style=color:#ae81ff>2</span>)
</code></pre></div><pre><code>2.3825017395837125
</code></pre><p>scikit-learnでは、下記のように求める。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># ユーグリッド距離を求める</span>
<span style=color:#f92672>from</span> sklearn.neighbors <span style=color:#f92672>import</span> DistanceMetric
dist <span style=color:#f92672>=</span> DistanceMetric<span style=color:#f92672>.</span>get_metric(<span style=color:#e6db74>&#39;euclidean&#39;</span>)
dist<span style=color:#f92672>.</span>pairwise(X_sc)
</code></pre></div><pre><code>array([[0.        , 2.38250174, 1.49437319, 3.45139085, 3.0731437 ,
        3.71098632, 4.07474207, 4.81815926, 4.67900277],
       [2.38250174, 0.        , 0.9768355 , 3.43706118, 3.00626276,
        3.37215001, 4.2890106 , 3.35412806, 4.16481359],
       [1.49437319, 0.9768355 , 0.        , 3.49802011, 3.02339402,
        3.55730355, 4.19933149, 3.9471889 , 4.43724864],
       [3.45139085, 3.43706118, 3.49802011, 0.        , 0.69858718,
        0.51383054, 1.76399106, 2.80787035, 1.43033416],
       [3.0731437 , 3.00626276, 3.02339402, 0.69858718, 0.        ,
        0.76941854, 1.53325205, 2.53474183, 1.61925829],
       [3.71098632, 3.37215001, 3.55730355, 0.51383054, 0.76941854,
        0.        , 1.78156825, 2.32331059, 1.04497594],
       [4.07474207, 4.2890106 , 4.19933149, 1.76399106, 1.53325205,
        1.78156825, 0.        , 3.0300838 , 1.75580771],
       [4.81815926, 3.35412806, 3.9471889 , 2.80787035, 2.53474183,
        2.32331059, 3.0300838 , 0.        , 2.10634259],
       [4.67900277, 4.16481359, 4.43724864, 1.43033416, 1.61925829,
        1.04497594, 1.75580771, 2.10634259, 0.        ]])
</code></pre><p>距離を求める方法としては、他に絶対距離（市街地距離、マンハッタン距離）、ミンコフスキー距離、マハラノビス距離がある。</p><h2 id=階層型凝集型クラスタリング>階層型（凝集型）クラスタリング</h2><p>scikit-learnで階層型クラスタリングを行う。<br><code>affinity</code>の値は距離の求め方（デフォルトはユーグリッド距離）、<code>linkage</code>はクラスター間の距離をどの点に基づいて求めるかを示す。<br><code>linkage</code>には、下記の種類がある。</p><ul><li>最短距離法（<code>single</code>）</li><li>最長距離法（<code>complete</code>）</li><li>平均距離法（<code>average</code>）</li><li>重心距離法</li><li>ウォード法（<code>ward</code>）※ウォード法を用いる場合、<code>affinity</code>はユーグリッド距離のみが使用できる</li></ul><p>ここではウォード法を用いる。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 階層型（凝集型）クラスタリング</span>
<span style=color:#f92672>from</span> sklearn.cluster <span style=color:#f92672>import</span> AgglomerativeClustering

ac <span style=color:#f92672>=</span> AgglomerativeClustering(
    affinity<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;euclidean&#39;</span>, 
    linkage<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;ward&#39;</span>,
    distance_threshold<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, 
    n_clusters<span style=color:#f92672>=</span>None)
ac<span style=color:#f92672>.</span>fit(X_sc)
</code></pre></div><p>階層型クラスタリングによって求めたクラスター間の距離を図示する方法として、デンドログラムがある。下記の関数を定義して描くことができる。<br>＜参考＞ <a href=https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_dendrogram.html>https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_dendrogram.html</a></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_dendrogram</span>(model, <span style=color:#f92672>**</span>kwargs):
    counts <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>zeros(model<span style=color:#f92672>.</span>children_<span style=color:#f92672>.</span>shape[<span style=color:#ae81ff>0</span>])
    n_samples <span style=color:#f92672>=</span> len(model<span style=color:#f92672>.</span>labels_)
    <span style=color:#66d9ef>for</span> i, merge <span style=color:#f92672>in</span> enumerate(model<span style=color:#f92672>.</span>children_):
        current_count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        <span style=color:#66d9ef>for</span> child_idx <span style=color:#f92672>in</span> merge:
            <span style=color:#66d9ef>if</span> child_idx <span style=color:#f92672>&lt;</span> n_samples:
                current_count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>  <span style=color:#75715e># leaf node</span>
            <span style=color:#66d9ef>else</span>:
                current_count <span style=color:#f92672>+=</span> counts[child_idx <span style=color:#f92672>-</span> n_samples]
        counts[i] <span style=color:#f92672>=</span> current_count

    linkage_matrix <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>column_stack([model<span style=color:#f92672>.</span>children_, model<span style=color:#f92672>.</span>distances_,
                                      counts])<span style=color:#f92672>.</span>astype(float)

    dendrogram(linkage_matrix, <span style=color:#f92672>**</span>kwargs)
</code></pre></div><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> scipy.cluster.hierarchy <span style=color:#f92672>import</span> dendrogram

labels <span style=color:#f92672>=</span> range(<span style=color:#ae81ff>1</span>, len(X)<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
plot_dendrogram(ac, labels<span style=color:#f92672>=</span>labels)
</code></pre></div><p><img src="data:image/png;base64,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" alt=img></p><p>このように、1番目から3番目までのデータ、4番目から6番目までのデータはうまくクラスターに分類できているが、7番目から9番目までのデータについては鎖状効果が発生しておりうまく分類できていない。</p><p>クラスターの各階層の距離を求める。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(ac<span style=color:#f92672>.</span>children_)):
    a <span style=color:#f92672>=</span> (ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>&lt;=</span> len(ac<span style=color:#f92672>.</span>children_) <span style=color:#66d9ef>else</span> ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-</span> len(ac<span style=color:#f92672>.</span>children_)
    b <span style=color:#f92672>=</span> (ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>*</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#66d9ef>if</span> ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>&lt;=</span> len(ac<span style=color:#f92672>.</span>children_) <span style=color:#66d9ef>else</span> ac<span style=color:#f92672>.</span>children_[i][<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-</span> len(ac<span style=color:#f92672>.</span>children_)
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%2i</span><span style=color:#e6db74> </span><span style=color:#e6db74>%3i</span><span style=color:#e6db74> </span><span style=color:#e6db74>%3i</span><span style=color:#e6db74> </span><span style=color:#e6db74>%0.3f</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span> (i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, a, b, ac<span style=color:#f92672>.</span>distances_[i]))
</code></pre></div><pre><code> 1  -4  -6 0.514
 2  -5   1 0.795
 3  -2  -3 0.977
 4  -9   2 1.630
 5  -7   4 1.994
 6  -1   3 2.226
 7  -8   5 3.139
 8   6   7 6.979
</code></pre><p>ここでは、4番目のデータと6番目のデータで形成した1つ目のクラスターの距離が0.514、5番目のデータと1つ目のクラスターで形成した2つ目のクラスターの距離が0.795であることを示す。</p><h2 id=非階層型クラスタリング>非階層型クラスタリング</h2><p>階層型クラスタリングで用いた9件のデータについて、非階層型クラスタリング手法であるK-Meansで3つのクラスターに分類する。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> sklearn.cluster <span style=color:#f92672>import</span> KMeans

kms <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
kms<span style=color:#f92672>.</span>fit(X_sc)

<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(kms<span style=color:#f92672>.</span>labels_)):
    <span style=color:#66d9ef>print</span>(kms<span style=color:#f92672>.</span>labels_[i])
</code></pre></div><pre><code>1
1
1
0
0
0
0
2
0
</code></pre><p>1つ目の品種については上手くクラスターを形成できているが、2つ目と3つ目の品種については上手くいっていない。</p><p>次に、150個すべてのデータを用いたクラスタリングを行う。まず、主成分分析を行い、第2主成分までを求めた上でK-Meansで3つのクラスターに分類する。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># 主成分分析を行い第2主成分までを使用する</span>
<span style=color:#f92672>from</span> sklearn.decomposition <span style=color:#f92672>import</span> PCA
<span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> StandardScaler

<span style=color:#75715e># すべてのデータを使用する</span>
X <span style=color:#f92672>=</span> iris<span style=color:#f92672>.</span>data

<span style=color:#75715e># 標準化</span>
sc <span style=color:#f92672>=</span> StandardScaler()
X_sc <span style=color:#f92672>=</span> sc<span style=color:#f92672>.</span>fit_transform(X)

<span style=color:#75715e># 主成分分析を行い、第2主成分までに射影する</span>
pca <span style=color:#f92672>=</span> PCA(n_components<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
pca<span style=color:#f92672>.</span>fit(X_sc)
X_projection <span style=color:#f92672>=</span> pca<span style=color:#f92672>.</span>transform(X_sc)

<span style=color:#75715e># K-Meansでクラスタリングする</span>
kms <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
kms<span style=color:#f92672>.</span>fit(X_projection)
kms<span style=color:#f92672>.</span>labels_
</code></pre></div><p>このような結果が得られる。やはり2つ目と3つ目の品種の分類は上手く行かない。</p><pre><code>array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 0, 0, 0, 2, 2, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0,
       2, 2, 2, 2, 0, 2, 2, 2, 2, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 0, 0, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 0, 0, 0, 0, 2, 0, 0, 0,
       0, 0, 0, 2, 2, 0, 0, 0, 0, 2, 0, 2, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0,
       0, 2, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 2], dtype=int32)
</code></pre><p>散布図を描く。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>%</span>matplotlib inline
<span style=color:#f92672>from</span> matplotlib <span style=color:#f92672>import</span> pyplot <span style=color:#66d9ef>as</span> plt

ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplot()

markers <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;x&#39;</span>, <span style=color:#e6db74>&#39;v&#39;</span>, <span style=color:#e6db74>&#39;o&#39;</span>]
colors <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;red&#39;</span>, <span style=color:#e6db74>&#39;green&#39;</span>, <span style=color:#e6db74>&#39;blue&#39;</span>]

<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>, len(X_projection)):
    ax<span style=color:#f92672>.</span>scatter(X_projection[i][<span style=color:#ae81ff>0</span>], X_projection[i][<span style=color:#ae81ff>1</span>], 
               marker<span style=color:#f92672>=</span>markers[kms<span style=color:#f92672>.</span>labels_[i]], color<span style=color:#f92672>=</span>colors[kms<span style=color:#f92672>.</span>labels_[i]])
plt<span style=color:#f92672>.</span>show()
</code></pre></div><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAW8AAAD4CAYAAAAjKGdbAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjEsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+j8jraAAAgAElEQVR4nO3df3Bd5Xkn8O9zZQusIBDBahEmkuxuA6kTLMZinOlQOzNJ02k6NQthO90KWkyJB3sWy3aaaTuuYjlUId0ZW9gzkOC263qw/E/b0GlDtrTdzrANYRnkIDbpbN1de2KKraTmh4gTYAy6z/7x6uiee+75fc+559f3M3NHOvfHOe8V5rnvfd7nfV9RVRARUbHUsm4AERFFx+BNRFRADN5ERAXE4E1EVEAM3kREBbSiExdZvXq1Dg8Pd+JSRESlcerUqddUtd/tsY4E7+HhYczOznbiUkREpSEi57weY9qEiKiAGLyJiAqIwZuIqIAYvImICojBm4iogDpSbZJXNx66EecvnW+5f03vGry699UMWkREFE6le95bb9qK7q7upvu6u7pxx013ZNQiIoJzpVOufOqq0sF7YvMEatL8J+iSLkxsmcioRUQVNzkJ7NnTCNiq5nhyMstW5VKlg/dA7wC2jWxb7n13d3Vj28g2XH/V9Rm3jKiCVIGFBeDw4UYA37PHHC8ssAfuIJ3YjGF0dFTzOsNy/tI81h1Zh3fffxerVqzC2fGzDN5EWbEHbMv4ODA9bX4XaX6u/biEROSUqo66PVbpnjfQ6H3XpMZeN1HWRBqB2jI9DRw4wHSKQ+WDN2By38N9w8x1E2XNCsp2u3cDb77JdIoDgzdM7/vMrjPsdRNlyR6Ux8eBet38PHLEPL5rl3msVms8Z3q69KkTLwzeRJQPIkBfX3NQnp42x9deCzz6aPPzKxy4gYpP0iGinJmcbB6ItOfAnemUPXsqHcDZ8yaifHELxm7pFHsOvILY8yaifPNKpwDm/or2vCtf501EBeGs62adNxFRATgDdckDdxAGbyKiAmLwJiIqIAZvIqICYvAmIiogBm8iogJi8CYiKqDSTtLh/pREVGal7Xlzf0oiKrPSBm/uT0lEZVba4M39KYmozEobvIHm3jd73URUJrGCt4j0isiTIjInIs+LyM8k3bAkcH9KIiqruD3vjwKYUdURADMAHk6uScni/pREVEaxSgVV9Xnb4bcA/HoyzUmetT8lEVGZJJHz3gTgOwmch4iqyrmvQEV3x4mireAtIlcD2AvgsMtj20VkVkRmL1682M5liKjMJiebtzOzdpGfnMyyVbkXO3iLyBUA/hLAl1W1JS+hqkdVdVRVR/v7+9tpIxGVlSqwsNC8H6W1X+XCAnvgPmLlvEWkBuDPAJxS1eOJtigjnE5PlAH7fpSHD5sb0LxfJbmK2/PeATNI+YmlcsE5EfkPCbar4zidnigj9gBuYeAOFLfa5DEAjyXclkiS7ilPbJ7AsbljTfdxYg9RB1ipErs9exjAAxR2hmXSPWVOpyfKgD3HPT4O1Ovmpz0HTq4KG7zTWHiK0+mJOkwE6OtrznFPT5vjvj72vH0UNnin0VPmdHqiDExONqdIrADOUkFfhQ3eQDo9ZU6nJ8qAs4fNHnegQgfvNHrK1nR69rqJKM8KHbwB9pSJqJoKv4clF54ioioqfM+biKiKGLyJiAqIwZuIqIAYvImICqjwA5ZJ8VorpSY11LXecj9XGySiLLHnvcRrrZSPrP4IVxskotxh8F7itVbKzF0zia+hQkTULqZNllizNf/0pT/F5cXLy2ulbLh+g+v99hmY3MiBiDqNPW8br7VSgtZQ4UYORNRpDN42XmulBK2hksbytEREfhi8HbzWSvFbQ4UbORBRp4l2YKeK0dFRnZ2dTf06WZq/NI91R9bh3fffxaoVq3B2/CyDNxG1RUROqeqo22PseSeEGzkQUScxeCeIy9MSUaewVDBBXJ6WiDqFPW8iogJiz9sFJ90QUd5VInh7BWOLMyhvvWnr8oxKCyfdEFGeVCJt4jYD0uIWlDnphirDWSrcgdJhSkYlgrdbMLa4BWVOuqFKmJwE9uxpBGxVczw52d55+YHQEZUI3s5gbPFaZEoOCL46+9XltMnlxcv4+v/5ekfbTNSWoACqCiwsAIcPNwL4nj3meGEBqNf9X+91TfsHgnVL4gOBWlQi5w2Y3vexuWNN93ktMuXMd9dQw10fuasj7SRq2+SkCcDT04BII4D29TWCqIh5HDAB+/Bh8/v4OHDNNcDevf6vd7vmm2+a348caQT7F14wt/Fxc59IOu+5gtrqeYvIF0RkXkR2J9WgtNhnQK7vX980E9LqbTt73Jburm7mu6kYgnrU9h60PYBbDh0C3nor3Oud1zxyxBzv2mV+P3LEBO5duxofBJQcVY19A/AxAH8CYLff8zZu3Kh5cOFHF3Td4XU6Nz+n6w6v0/lL86qquuMbO7T74W7FJFpu3Q93685v7My45UQR1Ouq4+P2xIU5rtfDPW9xMdzrg85l3fxeR74AzKpHXG17YSoRmQSwoKqPej0n7wtTzV+axw2HbvB+/PPzHKykYlEFarYv1vV6c8/X3qMeHzc9Y/vxoUNAV5f368Nc02KdH2DvOyK/halSy3mLyHYA2wFgcHAwrcskYqB3AOv71+OfL/5zy2Pr+9czcFOxWIHZbs+e5tSFiMlhW4HVnkKxct5+r3fmr+v11mtu2ABs2WI+EKxO4rXXcvAyIalVm6jqUVUdVdXR/v7+tC6TmBN3nmi5TyA4+dmTGbSGciEPJW9R2+DsUdfr5qc9h22ZnGwN6Pact9frnSWG9TqwcaPJcW/aZHLcGzYAL78MPPusOX7hBfO4V968k/Lw3zUBlak2CTIyMNLU++7u6sYDtz6AW376loxbRpkIU7GRxzb49aj7+lrTFs7jWs3/9UBjQBQwj+3dC8zNASMjwLe/bV4zOQmcP28C+Msvm+eOjJhefZapkzz8d02KVzI87A3AJAoyYBnkpQsvLQ9UrvrDVcsDmlQx9sE3a6DOeZz3NrgNTka9vtex30Cn1+NhBz7TZB+IdQ7MZtkuH/AZsGwnaN8AYA7ADwCcB/A/vJ5blOCtaipPagdqrDCpurAVG0Hn8DvuRBvSUq/7V5QsLqqOjDQ/Z2SkEeA7bf/++JU0GUoleEe5FSl4W+WE7HVTYIDyYwUL6zVWIN6/v3NtSEvQh0reet7Oby2Li81tyuoDJQS/4F2J6fFRWBsqsMKk4tSjYkNDThMPO1EmrTakxf5evAY0RUxue2Sk+bVZ5bytvL3VTnsJJGBy9ln+TePyiupJ3orU8yZKJOfdbsoj65y3H/u3CutmfauwH2c5ZuDGrcedh3b5gE/Pm9UmRE5RKza8zjE93ajKAKJNEW+nDVErKqzestex2/nrdeDAgcZ1Dh0yr7Gu0+7fL2mqrbXre/eadmfZrnZ4RfUkb2Xoea85uMZ1+vyag2uybhqlpZ3ea1KDjVHbELXXGyc3v3+/6q5d5gY0ft+0qfk6afb+o3DLeTuPcwpV73knsa0Zd9epoKCaaC/OvLB96jkQvQfudezVY/ZaLdB5XXtu3mqXvd1uPXDrNUeOmMk31iJUFmsRqqC2dlLQtxi3Kf0F0PbaJmFkvbbJzqd3ugbeB259AI/9ymOhzjF/aR7rjqzDu++/u3zfqhWrcHb8LAc3qdX+/WamohUs6nXzNT2pySBBqRENWNvEYv+gsbgF+qDX2K9jT6fkaSJM1PRQDvitbVLMjxwX9mVd7bcbD92YyLZm3F2HQpucNIHbygNb+dZrrkkmeAVVs7itM+JVpeK2LGzQNwO311h27zbreoettAk6TlLcb1I5VZrg7bZPpZXWSCrw2j8EuKclubIHVqsEzQpeb70VrUzQ69hZ+larNa8GuHdvuLVNrPNGLUdUBT7+8eb7HnrIlALa1/R2ts35oZDWNmxV4ZUMT/LWiQHLCz+6oFf+4ZVNg4n2Ke72x/2mvgcNTHIGJgUKM4nF+Xy7sIOIXhN4orw+aklfvd4YqLRmTT70UPPxF78YPLkor+WEOYOqzLC0b6rgtolCmMDrtjGD/VycgUmhxA2sYYNaux8QliSqTazbpk2mcqPdzSAYuJdVJngH9a6dgderl+12c56LpYPkKcwONe0G5iR7rXFK+qxSQOcHVNS25XH6f474Be/clgrGKe+zcttPnHrCNadtTX33O78btw0ZWDpIrjSgTNCaFOJXxhc0wSeo9M2tTUEDkH7HXtxy5YcOhZ+gY/2t7HbvBh591HvTh7Q4r9Op67YhtwOWfgOQfiY2T2C4bzhwMNHt/F7cNmTwq2Dxq3yhkrMCq33T3elpc2zVFAdVd7gFtTAbKVjnTXsQ0P4BNTICLC42BkU3bjSPu7XN3gbnh1y9bjZyOHLEBHCrL96JAcyCDpzmNnjHLe8Lu7CU2/kB4MPXfbgpqK/vX++6IYOzggUA3nn/HQwcHHDt0bNXTgCCA7NbUPOqFnHrGSaxIFYQEeCll4DVq80mDHv3AgcPNo7fesv9Nc5jew8dMMEbMLvuAOm03UkDyi7Tum4SvPIpSd7i5ryDBiDb5Ryc7DrQpXPzc8t5c5kUffkHL3u+3q3CxevGzR0qwi/nax/k88sHt7OcrLMaxLpukrlke7vbXbPbucmDs+2dGMDM8cAp0tw9Poy4MyztsxrTmM3onDV534b7cOw/HsPOp3fiiVNP4MGNDwbOwNz59E58bfZrqEkNi7q4fH+XdKGr1oXLi5cjz+akgrP33ixWDzPs7MO4OdjJSTNJxjllPemNf93eI2BSKO1MN1cNNzM0aVldN0BhZ1haqYma1FKZzWidXyDo7e7FI596BADw1L88hbrW8fjs44E564nNE1h77Vrcc8s9TZOA7vnYPZzQU1V+sxa9ctXOwBpnEFG1NXAD5vjNN5NNAYiYVIlTO2tjh8n1pyGr67Yp18EbCD8A2c751167Fv/60L8ufzjcefOdoQdLrRz7I598pClYf+UXv5LqBw/lWF6DgT2v7vYzii9+Ebje8W969WrvmZxh2haU63eeM4m/Z5QxhpzJbamgxV7e14nze5UQXl687PsB4lamOLF5As+ceYa97ioJKhW85prmBau80iZxiJj0iNtKfy+/3FhfxVp3xX4c5fr1OvA3fwO89poJ2D/4ATA6agYrV68Grr46esohqPwxrcWukli7PSO5D96dEKbme4WswMDBgZb77XXnzmCd9gcP5ZBfMLACZZQlWKPav9+U2tmpAhs2NEr75uaAZ581P63jKNev1YCtW83vc3PAiqUwMjJi7j9wIF7brdUQvcof0/q7eV03x4EbqMiSsEHclox1+rWf+zX81em/amtZWaoQrwFHv8HMdoOFX69/1y7zHGc+vJ3r1+vN+0G2O1jpJ82/W475DVgyeMN9rW679f3r8ff3/j3X86ZkpFnZ4LfO9/797sE1zvWzCKY5rQhJU2GrTTrFOeFmZW0lusT0KASCk589yfW8KRlpD2Z6VbPs39963bjXz2KQL6+DwBmqXM47TH77vfp7y7/vGN2xPMNyYvMEjs0dA8DyP4ohaDAzqV6r2zns09ntue6RkejX7/QgX6f+bgVTueDttqBUDTVAgLrWl+9bWVuJVStXNQXooIWviHyFCXpxJ+eEve411wBbtjRXm2zZEj3odnKQr8AVIWmqXM7bLb99ZdeVAIB3F4Pz2fOX5nH7sdvx3P3PeQbvJDY8phLzCtBB+1ImdV2vn3mXxgdbzlUy5+21st9tf3xbS+76/lvvx7Zbw+Wzwyx8FXdFRKoIW8CZmQGG1wpqovhvh1JeIMneS3b7mXdF24MyjUlFNqUN3n4B1G0vyqf+5anlVMrlxcvLU+PjLOOaxIbHVBwzM8DwsCmEGB42x2Fft20bcO4coBD89qVp3CfHg/d+pPzrwDKzsYO3iHxORL4nIs+LyNrEWpQQvwDqtmbKnTff2fL8uL1lVqZUx8wMsH37UgBW83P79nABfHwceO89+z2C43ovZvCfG3clVf/td0zJ0g4tM+u13KDfDcBPATgD4AMAPgPgKb/nd2obNCe/JWWdW6Jd+NEFveLhKxJbxjXshsdUbENDzSuJWrehoeDXur0OUL0O/57c0qTtLC9L8SW0zCx8loSN2/P+NIBTqvoTAM8A+HkRl50NMuaWHrE4c9cDvQO4/9b7E+stp70iIqUvTDrklVfcX3vuXLQUit3rWI2ZEyFrp/161Z3qAVIrv5Ulk+IV1f1uAL4A4GHb8WkAqx3P2Q5gFsDs4OBge59ibQizY7wl6d4yd5ovrhMnVHt6mjtOPT3mfjuvnrffayzXXef9uqEhDe4lh+lV53ijgVLrQM+7neA9ZTu+AOA6r+dnlTZRjR5AowR7Kq+w6RC3IB82hXLihPdrRJae5PU/e5Rd2rlDe2dF+W8TII3gPQbgL5Z+vxrAOwBqXs/PMnhHxd4yqZrg6RdUT5wwQVnE9KD9etHLgdiF1+vC5MxD9e7S6nk7X88PhGYJjTWkEbz70Riw3Arg637PL1LwpnKwB9ehIe/UhRe/nrdXSiVOIA6bnvHk16tOsAe4fD7VRmCy9qrkIKi7BD7g/IJ3rEFGVb0I4MsAXgDw+wA+H+c8eeI1qSdOnTdlK275nn2A8sc/BlaubH68pweYmgL27QPefrv5Meu4p6f5fhHgM5/xvubYGHD0KDA0ZJ47NGSOx8ZCDJiq+i/W5DWtfHw83nT4PXvMIlTWIOjGjY0FrzgI2irtSUVeUT3JWxF63s6d5NPasZ7Sl1QPuLvbnMvZe/dKqQCqV13Vel+knrRPe5rOEzXnbRenx20/9+Ji667xHARNBYq6e3wnua15wvW6i2dmBrjnHvfHREzH0c3wsOmhOw0NAd//frjnWsuEuHE7j59Q7Ul7LRQ769zO3eItFVhbOwuVXNskKs6KLId9+7wfGxw0P93SEV712m73T025p0f8+kFe54/6/Kb7w+5EnwS3umW7iq+tnQUGbxu/ST1UDH5BcmrKOx/+wQ+6v8YK+HZueeqguOV2njjPFzF7/C5/8Jzs0GJNbvn1kRGz9VlBdlsvm8qs5x1mEwY79rqLaXDQPd1w3XUm6A4Puw82rlpletP2x6wBSjdjY+Zm8UpzBJ3Hy9SU+VBxtrVeB15/3fxuffBY7UmNPWVirQn+139tNnPYu9esDQ5Uem3tLFSm5+22ymANtZbFqFbWVuLqK65mr7ug3FIaPT2NVK1Xz/yNN7yrPuJeFzAfGlHOY7F69/b9fd28/bZ/qigRzqqVAweAU6caVSu1WnrpGvJUiQFLv173lV1XhtqEgYpjZsYEtFdeMT3xqalG8IwyMJnkdeOq1YIzEX4DsaGohtvkIOzzKDGVH7B063UDZlf4sJswUHGMjZlAXK+bn/YA6lVz7VeLHVRvbT1+773m+MknW68bV5hcedR8epMo604XbTOEkqtE8HZb2xsATn72JAcpCy7qRgjf/Ga0+4Mm/LSznncYXukYS5R8euvfSrnqYIGVIm0SZs/InU/vbNp4eH3/enxv5/eWH3vi1BNYtWIVfvLeTwKvx70o88EKnM5BRr8cs1cawiv1EJRmSTMNY7GnY6yqmDfeiJaa8f5bKcZedNRvc/ee3Ch92iTMnpH2HrZAcPKzJ5seG+4bxt0/d7dresXvvJQdr2nqYWq9w94fVG8dpT48Lnsa6LXXzM0tJQR4fxPx/lt1YN1pSkUpgneYPSPtmyPsGN2BW376lqbHzuw6g0c++YhresXvvJSdOIHTqxrFK/UQFOyjfhikyS+F4/23ClgfhXKrFME77OxIq4ftFXyt86ysrXR9nAOa+RIncPotBOUmKNhH/TBIk983Ec+/1VVvNuq36yF376F88Fr0JMlbJxamSmoXHPt5nDfuRZkvbS+nGuE6fsvLtrv8bFLn8FuD3PNvdddfcI/LHEPS63lHvXVqVcGwu+CsObjGNTivObhm+TwyKdp1oEsxCe060KUyKVxhMIfiBj2/1yURSKNI6kMoaPcfz/fFjRVyyy94l6LaxDJ/aR63H7sdz93/nG9qw1l5ApiUyAO3PoDHfuWx5fP8wuAv4Mn//STu/di9+Kd/+6eW84apcqH88atSAaJXsLTLq2Klq8tkMsJWlcSpvqF886s2KVXwDivs8q9BHwZBHwKUT37lfUD6pX9OYWZRhg3CaczypOwweLuwB16/gOvXu37xcy9yDfAC8qv1BqLVgSfBb1EruzQ/QBLHqfSJKH2ddxxhZ1ZuvWmr6/3nL53HbX98G9cALyC/KpUsSv+CZlFazp0DVqwwMXDFCmDnzvTa1JYoU+4ptsoGb3vdd01qGDg44Lp/5cTmCXRJ69Ju1mQdTq8vHr/yvixK/5zli34rCS4uNn5+9as5DODKKfedUtngDfjPrLSC80DvAMY+1po0tAK1/UOAve7iWLWq8bt92daodeBJsc+iPH48XE8caAyy5oZ9k+PDh02Oyqoj58zNRFU2520XNIA5f2keH5r+EBbVdHucOfKwVS6UDefaIJcuAZcbY8y5rMhwDjz65cRz2ZlVNYHbwj0uY2HOO0DQDE1n79tt6v2ZXWcYuHPIOWX89debAzfQoQ0NInIua+uXSklqBcPEuG2ZxhmbiWPwXhKUu/7Kp76C3u5eCITpkQJxmzLu5ty5cEvKZsXa7szrsdy027llGqfcp4bBe0lQ7nqgdwCn/8tprL12LQclCyTK6n5Jr8WdpMcfB3bscH8sV98cnFum2XPg3OMyUaXOeUedAcncdfmEraG2y3M9ddT1yIOkNqmHdd6JqGzOO8w633bMXZePW+nfypWmwsRLkmtxJ82r3rxWi/6NIdVdgLhlWuoKGbxvPHRjS022VZdtF2adbyo3t9K/Y8fMhgbWdHinLNbiDstrQs/iYvTAG2czC8qPQgbvsD3qsOt8U7l5bUjsFQh//ON85r2BxoeRW/VJ1MDbiV2AKD2xgreI/KyIPCMibyTdoDCi9Kg5A5K8WIHQmUJ5/fX8DlwCpt1e+e0ogTdPuwBRdHF73q8B2N/G69sSpUfNGZDVEHUXecvYGHDVVa335z19kETgzdMuQBSD10LfYW4AFsI8L43NGKLsnHPhRxd03eF13AWnZKzNBazdYuJuZuC3A01eJbWBQ6c3nqBokNZOOn7BG8B2ALMAZgcHB1N5Y2F3zqHycQteXjvIBAnagSavGHjLzy94B9Z5i8g+AL/suPs3VfWsiCyoal9Q7z6tOu84ddnc/aYcwtRvB9U+WzXO586Z59r/V8jjeidUPW3VeavqlKre7ridTb6Z0cWpy45a+035FGZgzi//a69xBprnkHRqJUGidhSyVLAdrP0uh6CBuaCBN7caZ9XG7MqiBO64A7VUfHFLBb8kInMAekVkTkT+U8LtSg1rv8vBrVIiSs+5DDXOqc6QpNwr9domXuzrd3PPyeJqZ10Ov02I87quiVMZ3gP5q+zaJl5Y+10OXjMnwyhDjXMZvj1QfJUM3kBjCzTmuqspq+3OksQZktVW2eDNFQSrxW1gr52eex6U4dsDxVfZ4E3V4TWwt3NnsSs1yvDtgeKr5IAlVYvXwB4n5lDeccCSKs1rAM/Zb8nTYlSs36YgDN5UelEG8PJQqcH6bQqDwZtKz29Cj1MeKjW4ww2FweBNpec2sPfgg/mt1GD9NoXB4E2V4CwLfPzx/FZqsH6bwmDwpsrKa50367cpDAZv6pgiVFDkoY2s36YwGLypI9KuoPAKulGCcZ6qPPL6rYDyg5N0qCPSXAHPCrr2Co2eHuC3fgs4frz1fq9eLFfpo7zhJB3KXJoVFF6ldUePRiu5K1qVRx5SPJQdBm/qiDQrKLyC6+JitOcXqcojTykeygaDN3VEmhUUXsG1qyva84tU5cGJPMTgTR2RZgWFV9Ddvj1aMC5SlYfXt4dz59j7rgxVTf22ceNGJUrTiROqQ0OqIubniRP+9xfd0JCqSZi03np6yvM+qw7ArHrEVfa8qRS8Suviltz5DQbmYaDQ7duGhemTaliRdQOI8sZZemgNBlq8HutkesW61j33uD+e1woZSg7rvIkc/Oq9gXzVgrM2vdxY502ZykOaIQq/eu+81YIXqUKGksXgTakqYj2yX7133mrBi1QhQ8li2oRSVcSv9V7T7Y8eNb97PcaASUnzS5twwJJSlbc0QxhWEN63z7RzcNCkIezB2e8xok5gz5tSVcSeN1FecMCSMsMBNaJ0xAreInKHiHxbRE6LyB8k3SgqD78BtaJVoRDlSeSct4gIgJsBfAqAAjgtIn+uqqeTbhyVw9hYa07YbyIM88dEwSL3vJem3P+Rqr6tqu8A+A6ADyXfNCozropH1J62ct4ishLALQC+6/LYdhGZFZHZixcvtnMZKqEiVqEQ5Ulg8BaRfSLyLcdt3dLDDwL4R1X9ofN1qnpUVUdVdbS/vz/pdlPB5W2yC1HRBOa8VXUKQEttgIj8EoD7AHwi8VZR6U1NuU92YRUKUThxq01uA/A4gLtU9VKyTaIq4LRuovbEmqQjIhcBvAPgIoAuAP+gqr/j9XxO0iEiii7x6fGqyiQ2EVGGOMOSiKiAGLyJiAqIwZuIqIC4JGyCbjx0I85fOt9y/5reNXh176sZtIiIyoo97wRtvWkruru6m+7r7urGHTfdkVGLiKisGLwTNLF5AjVp/pN2SRcmtkxk1CIiKisG7wQN9A5g28i25d53d1c3to1sw/VXXZ9xy4iobBi8E2bvfbPXTURpYfBOmNX7rkmNvW4iSg2DdwomNk9guG+YvW4iSg1LBVMw0DuAM7vOZN0MIiox9ryJiAqIwZuIqIAYvImICojBm4iogBi8qVBmZoDhYaBWMz9nZrJuEVE2WG1ChTEz07zv5blz5hjg9mlUPex5U2Hs29e8YTFgjvfty6Y9RFli8KbCeOWVaPcTlRmDNxXG4GC0+4nKjMGbCmNqCujpab6vp8fcT1Q1DN5UGGNjwNGjwNAQIGJ+Hj3KwUqqJlabUKGMjTFYEwHseRMRFRKDNxFRATF4ExEVEIM3EVEBMXgTERWQqGr6FxG5COCc7a7VAL2258kAAANySURBVF5L/cLp4/vIF76PfOH7aN+Qqva7PdCR4N1yUZFZVR3t+IUTxveRL3wf+cL3kS6mTYiICojBm4iogLIK3kczum7S+D7yhe8jX/g+UpRJzpuIiNrDtAkRUQExeBMRFVAmwVtEdovIiyLyfRH5kohIFu1ol4jcISLfFpHTIvIHWbcnLhH5WRF5RkTeyLotcYnI50TkeyLyvIiszbo9cYnIF0RkXkR2Z92WuESkV0SeFJG5pf8eP5N1m+IQkbUi8o2lf1ezIvKRrNtkl1XPexbAxwHcDOC3AXwoo3bEtvSBczOATwEYAbBdRG7KtlWxvQZgPwr6TUxEfgrA7wHYBOBhAIeybVFb/hbA01k3ok0fBTCjqiMAZmD+mxTRuwD2qOpHARwH8IWM29Mkk/9ZVfVbAAQm6C0AuJBFO9qhxh+p6tuq+g6A76CAH0IAoKpvqur/yrodbfg0gFOq+hMAzwD4eREp5AeRqn4XwKtZt6Mdqvq8qv7t0uG3ABRyozpVnVfV/7vUOfgwgFNZt8kuy3/g3wTwHICdqvp+hu1om4isBHALgO9m3ZaKGgBwGgBUdRGmQ/DBTFtElk0wHZtCEpEtMJ3LDwP4WsbNaZL6Tjoisg/ALzvu/k1V/fRSmuEvReSTqvrDtNvSDp/3cRbAgwD+Me/vAQh8H0Vm74j0AmANbMZE5GoAewF8Juu2xKWqz4pID4DfB/BfAXw+4yYty7zOW0QehfnK+2SmDYlJRH4JwJcBfEJVL2XdnnaIyIKq9mXdjqhEZAzAnap691LA+CGAD6hqPeOmxSIikwAWVPXRrNsSl4hcAeAbAE6o6vGs29MuEemDiVO5GXzteNpERK4Tkd8VkRVL/6N9Gs0rDhaGiNwG4HEAdxU9cBfc3wG4VUQ+AOATAP57UQN3GSyNN/wZTLArbOBeqmC6eak44W7kLE5lsQHxAoAPAHgRJi95TFX/ZwbtSMI3AbwD4Osi0gXgH1T1dzJuU2Qi8iUAWwH0isgcgClV/fOMmxWaql4UkS8DeAHAJQC/kXGTYhGRG2D+TV0PYFFEflVVP5lxs+LYAeDXAbyw9O8JAO5W1f+XYZvieAGmc3YDgLcA3JdpaxwyT5sQEVF0hSynIiKqOgZvIqICYvAmIiogBm8iogJi8CYiKiAGbyKiAmLwJiIqoP8PUXUa766VwD4AAAAASUVORK5CYII=" alt=img></p></article></section></div><footer class=footer><section class=container>©
2020 -
2021
Inoue, Ken'ichi</section></footer><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js id=MathJax-script></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}}</script><script src=https://code.jquery.com/jquery-3.5.0.min.js integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/typed.js@2.0.11></script><script src=https://inoccu.github.io/js/main.js></script></main><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-2794204-22','auto'),ga('send','pageview'))</script></body></html>